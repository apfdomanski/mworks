<?xml version="1.0"?>
<monkeyml version="1.0">
    <filters _id="id29672" tag="Filters">
        <filter _id="id29674" type="boxcar_filter_1D" in1="eye_h_calibrated" out1="eye_h" width_samples="5"></filter>
        <filter _id="id29685" type="boxcar_filter_1D" in1="eye_v_calibrated" out1="eye_v" width_samples="5"></filter>
        <filter _id="id29696" type="basic_eye_monitor" eyeh_calibrated="eye_h" eyev_calibrated="eye_v" eye_state="saccade" width_samples="5" saccade_entry_speed="60" saccade_exit_speed="20"></filter>
    </filters>
    <io_devices _id="id29715" tag="IO Devices">
        <iodevice _id="id29716" tag="FakeMonkey" priority="" type="fake_monkey" id="" alt="" spike_rate="spike_rate">
            <iochannel _id="id29732" type="eye_movement" eye_v="eye_v_raw" eye_h="eye_h_raw" data_interval="1ms" update_interval="10ms"></iochannel>
            <iochannel _id="id29745" type="spike" variable="spikes"></iochannel>
            <iochannel _id="id29752" type="juice" variable="reward"></iochannel>
        </iodevice>
    </io_devices>
    <calibrators _id="id29758" tag="Calibrators">
        <calibrator _id="id29759" tag="eyeCalibrator" type="standard_eye_calibrator" eyeh_raw="eye_h_raw" eyev_raw="eye_v_raw" eyeh_calibrated="eye_h_calibrated" eyev_calibrated="eye_v_calibrated"></calibrator>
    </calibrators>
    <variables _id="id29776" tag="Variables">
        <folder _id="id29777" tag="Calibrator variables">
            <variable _id="id29781" tag="fixation_point_size" default_value="0.4" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable _id="id29799" tag="fixation_pos_y" default_value="0" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable _id="id29817" tag="fixation_pos_x" default_value="0" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable _id="id29836" tag="fixation_width" default_value="2" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable _id="id29854" tag="stm_selector_y" default_value="0" scope="LOCAL" type="INTEGER" editable="never" logging="never" persistant="NO"></variable>
            <variable _id="id29872" tag="stm_selector_x" default_value="0" scope="LOCAL" type="INTEGER" editable="never" logging="never" persistant="NO"></variable>
            <variable _id="id29890" tag="eye_v" default_value="0" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable _id="id29908" tag="eye_h" default_value="0" scope="GLOBAL" type="FLOAT" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable _id="id29926" tag="eye_v_calibrated" default_value="0" scope="GLOBAL" type="FLOAT" editable="never" logging="never" persistant="NO"></variable>
            <variable _id="id29945" tag="eye_h_calibrated" default_value="0" scope="GLOBAL" type="FLOAT" editable="never" logging="never" persistant="NO"></variable>
            <variable _id="id29963" tag="eye_v_raw" default_value="0" scope="GLOBAL" type="FLOAT" editable="never" logging="never" persistant="NO"></variable>
            <variable _id="id29981" tag="eye_h_raw" default_value="0" scope="GLOBAL" type="FLOAT" editable="never" logging="never" persistant="NO"></variable>
            <variable _id="id29999" tag="fixation_duration" default_value="800000" scope="GLOBAL" type="INTEGER" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable _id="id30018" tag="ignore" default_value="0" scope="GLOBAL" type="INTEGER" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable _id="id30036" tag="failure" default_value="0" scope="GLOBAL" type="INTEGER" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable _id="id30054" tag="success" default_value="0" scope="GLOBAL" type="INTEGER" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable _id="id30072" tag="reward" default_value="0" scope="GLOBAL" type="INTEGER" editable="never" logging="when_changed" persistant="NO">
                <action _id="id30090" type="play_sound" sound="reward_sound"></action>
            </variable>
            <variable _id="id30096" tag="reward_duration" default_value="100000" scope="GLOBAL" type="INTEGER" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable _id="id30114" tag="miss_count" default_value="0" scope="GLOBAL" type="INTEGER" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable _id="id30133" tag="number_of_stm_shown" scope="GLOBAL" type="INTEGER" editable="never" logging="when_changed" default_value="0" persistant="NO"></variable>
            <variable _id="id30151" tag="eye_in_window" default_value="0" scope="GLOBAL" type="INTEGER" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable _id="id30169" tag="vertical_refresh" default_value="0" scope="GLOBAL" type="INTEGER" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable _id="id30188" tag="saccade" default_value="0" scope="GLOBAL" type="INTEGER" editable="never" logging="when_changed" persistant="NO"></variable>
            <variable _id="id30206" tag="spikeWaveform" default_value="0" scope="GLOBAL" type="FLOAT" editable="ALWAYS" logging="WHEN_CHANGED" persistant="NO"></variable>
            <variable _id="id30224" tag="spikes" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="NO"></variable>
            <variable _id="id30242" tag="spike_rate" default_value="30" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="NO"></variable>
            <variable _id="id30260" tag="vertical_refresh" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="NO"></variable>
        </folder>
        <folder _id="id30278" tag="RSVP variables">
            <variable _id="id30282" tag="stm_size" default_value="5.4" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" persistant="NO" logging="WHEN_CHANGED"></variable>
            <variable _id="id30300" tag="number_repeats" default_value="2" scope="GLOBAL" type="INTEGER" editable="ALWAYS" persistant="NO" logging="WHEN_CHANGED"></variable>
            <variable _id="id30318" tag="ITI" default_value="500" scope="GLOBAL" type="INTEGER" editable="ALWAYS" persistant="NO" logging="WHEN_CHANGED"></variable>
            <variable _id="id30337" tag="stimoff_time" default_value="100000" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="NO"></variable>
            <variable _id="id30355" tag="stimon_time" default_value="100000" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="NO"></variable>
            <variable _id="id30373" tag="imagesetsize" default_value="100" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="NO"></variable>
            <variable _id="id30391" type="selection" tag="RSVP_test_stim_index" values="0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99" selection="random_without_replacement" nsamples="1" sampling_method="cycles"></variable>
            <variable _id="id30412" tag="imageGroup_repetition" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="NO"></variable>
            <variable _id="id30430" tag="images_shown" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="NO"></variable>
            <variable _id="id30449" tag="number_of_stm_shown" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" logging="WHEN_CHANGED" persistant="NO"></variable>
            <variable _id="id30467" tag="show_N_images" default_value="6" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="NO"></variable>
            <variable _id="id30485" tag="stimon_delay" default_value="160000" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="NO"></variable>
            <variable _id="id30503" tag="ignore_time" default_value="2000000" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="NO"></variable>
            <variable _id="id30521" tag="stm_pos_y" default_value="5" scope="GLOBAL" type="DOUBLE" editable="ALWAYS" logging="WHEN_CHANGED" persistant="NO"></variable>
            <variable _id="id30540" tag="stm_pos_x" default_value="0" scope="GLOBAL" type="INTEGER" editable="NEVER" logging="WHEN_CHANGED" persistant="NO"></variable>
            <variable _id="id30558" tag="sync" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" persistant="NO" logging="WHEN_CHANGED"></variable>
            <variable _id="id30576" tag="random_number" default_value="0" scope="GLOBAL" type="INTEGER" editable="ALWAYS" persistant="NO" logging="WHEN_CHANGED"></variable>
        </folder>
    </variables>
    <stimuli _id="id30594" tag="Stimuli">
        <stimulus_group _id="id30595" tag="RSVP_images">
            <range_replicator _id="id30599" from="1" to="100" step="1" variable="RSVP_stim_counter">
                <stimulus _id="id30610" tag="OSImage_$RSVP_stim_counter" type="image_file" path="./images/RSVP_images/OSImage_${RSVP_stim_counter}.png" x_size="stm_size" y_size="stm_size" x_position="stm_pos_x" y_position="stm_pos_y" rotation="0" alpha_multiplier="1"></stimulus>
            </range_replicator>
        </stimulus_group>
        <stimulus _id="id30640" tag="fixation_dot" type="fixation_point" color="1,0,0" trigger_width="fixation_width" trigger_watch_x="eye_h" trigger_watch_y="eye_v" trigger_flag="eye_in_window" x_size="fixation_point_size" y_size="fixation_point_size" x_position="fixation_pos_x" y_position="fixation_pos_y" rotation="0.0" alpha_multiplier="1.0"></stimulus>
        <stimulus _id="id30681" tag="blank screen" type="blank_screen" color="0.5,0.5,0.5"></stimulus>
    </stimuli>
    <sounds _id="id30689" tag="Sounds">
        <sound _id="id30690" tag="stm_on_sound" type="wav_file" path="./sounds/stm_on.wav"></sound>
        <sound _id="id30699" tag="reward_sound" type="wav_file" path="./sounds/reward.wav"></sound>
        <sound _id="id30708" tag="failure_sound" type="wav_file" path="./sounds/failure.wav"></sound>
        <sound _id="id30717" tag="complete_sound" type="wav_file" path="./sounds/complete.wav"></sound>
        <sound _id="id30726" tag="acquire_sound" type="wav_file" path="./sounds/acquire.wav"></sound>
    </sounds>
    <experiment _id="id30734" tag="Experiment">
        <protocol _id="id30738" tag="calibration protocol" selection="sequential_ascending" nsamples="1" sampling_method="cycles" interruptible="YES">
            <block _id="id30754" tag="calibration block" selection="sequential_ascending" nsamples="1" sampling_method="cycles" interruptible="YES">
                <trial _id="id30771" tag="calibration trial" selection="sequential_ascending" nsamples="1" sampling_method="cycles" interruptible="YES">
                    <task_system _id="id30787" tag="calibration start">
                        <task_system_state _id="id30791" tag="StartIO_state" interruptible="YES">
                            <action type="start_device_IO" device="FakeMonkey" tag="Start Device IO"></action>
                            <action _id="id30804" type="report" message="********** STARTING CALIBRATION **********" tag="Report"></action>
                            <action _id="id30810" type="clear_calibration" calibrator="eyeCalibrator" tag="Clear Calibration"></action>
                            <action _id="id30817" type="assignment" variable="number_of_stm_shown" value="0" tag="Assignment"></action>
                            <action _id="id30825" type="assignment" variable="miss_count" value="0" tag="Assignment"></action>
                            <action _id="id30834" type="assignment" variable="fixation_width" value="fixation_width" tag="Assignment"></action>
                            <transition _id="id30842" type="yield"></transition>
                        </task_system_state>
                    </task_system>
                    <list _id="id30846" tag="calibration_list" selection="random_without_replacement" nsamples="1" sampling_method="cycles" interruptible="YES">
                        <range_replicator _id="id30860" tag="fixation_selection_H" from="-15" to="15" step="5" variable="stm_selector_x">
                            <range_replicator _id="id30874" tag="fixation_selection_V" from="-15" to="15" step="5" variable="stm_selector_y">
                                <task_system _id="id30888" tag="calibration task" interruptible="YES">
                                    <task_system_state _id="id30897" tag="cal target selection" interruptible="YES">
                                        <action _id="id30906" type="assignment" variable="fixation_pos_x" value="stm_selector_x" tag="Assignment"></action>
                                        <action _id="id30914" type="assignment" variable="fixation_pos_y" value="stm_selector_y" tag="Assignment"></action>
                                        <transition _id="id30923" target="cal pause" type="direct"></transition>
                                    </task_system_state>
                                    <task_system_state _id="id30929" tag="cal pause" interruptible="YES">
                                        <action _id="id30938" type="start_timer" timer="cal_timer" duration="1000ms" tag="Set Timer"></action>
                                        <transition _id="id30946" target="cal wait" type="timer_expired" timer="cal_timer"></transition>
                                    </task_system_state>
                                    <task_system_state _id="id30955" tag="cal wait" interruptible="YES">
                                        <action _id="id30964" type="assignment" variable="fixation_point_size" value="0" tag="Assignment"></action>
                                        <action type="live_queue_stimulus" stimulus="fixation_dot" tag="Live Queue Stimulus"></action>
                                        <action _id="id30979" type="update_stimulus_display" tag="Update Stimulus Display"></action>
                                        <transition _id="id30983" target="cal stm on" type="conditional" condition="eye_in_window == 0"></transition>
                                    </task_system_state>
                                    <task_system_state _id="id30992" tag="cal stm on" interruptible="YES">
                                        <action _id="id31000" type="play_sound" sound="stm_on_sound" tag="play stm_on_sound"></action>
                                        <action _id="id31009" type="assignment" variable="fixation_point_size" value="0.4" tag="Assignment"></action>
                                        <action _id="id31018" type="update_stimulus_display" tag="Update Stimulus Display"></action>
                                        <transition _id="id31022" target="cal prefixation" type="direct"></transition>
                                    </task_system_state>
                                    <task_system_state _id="id31028" tag="cal prefixation" interruptible="YES">
                                        <action _id="id31037" type="start_timer" timer="prefixation_timer" duration="1500ms" tag="Set Timer"></action>
                                        <action _id="id31046" type="fake_monkey_saccade_and_fixate" duration="fixation_duration*rand(1, 1.15)" fake_monkey="FakeMonkey" h="fixation_pos_x" v="fixation_pos_y" tag="Fake Monkey Saccade and Fixate"></action>
                                        <transition _id="id31060" target="cal ignore" type="timer_expired" timer="prefixation_timer"></transition>
                                        <transition _id="id31068" target="cal acquire" type="conditional" condition="(eye_in_window == 1) #AND (saccade == 0)"></transition>
                                    </task_system_state>
                                    <task_system_state _id="id31077" tag="cal acquire" interruptible="YES">
                                        <action _id="id31086" type="play_sound" sound="acquire_sound" tag="play acquire_sound"></action>
                                        <action _id="id31095" type="start_timer" timer="cal_timer" duration="fixation_duration" tag="Set Timer"></action>
                                        <transition _id="id31104" target="cal fixation" type="direct"></transition>
                                    </task_system_state>
                                    <task_system_state _id="id31110" tag="cal fixation" interruptible="YES">
                                        <action _id="id31119" type="begin_calibration_average" calibrator="eyeCalibrator" tag="Begin Calibration Average"></action>
                                        <transition _id="id31125" target="cal failure" type="conditional" condition="eye_in_window==0"></transition>
                                        <transition _id="id31134" target="cal fixation monitor" type="conditional" condition="saccade==1"></transition>
                                        <transition _id="id31143" target="cal pre reward" type="timer_expired" timer="cal_timer"></transition>
                                    </task_system_state>
                                    <task_system_state _id="id31151" tag="cal fixation monitor" interruptible="YES">
                                        <action type="end_calibration_average_and_ignore" calibrator="eyeCalibrator" tag="End Calibration Average and Ignore"></action>
                                        <transition _id="id31167" target="cal fixation" type="conditional" condition="(eye_in_window == 1) #AND (saccade == 0)"></transition>
                                        <transition _id="id31176" target="cal failure" type="conditional" condition="(eye_in_window == 0) #AND (saccade == 0)"></transition>
                                    </task_system_state>
                                    <task_system_state _id="id31185" tag="cal pre reward" interruptible="YES">
                                        <action _id="id31194" type="start_timer" timer="cal_timer" duration="30ms" tag="Set Timer"></action>
                                        <transition _id="id31202" target="cal success" type="conditional" condition="saccade==1"></transition>
                                        <transition _id="id31211" target="cal success" type="timer_expired" timer="cal_timer"></transition>
                                    </task_system_state>
                                    <task_system_state _id="id31220" tag="cal success" interruptible="YES">
                                        <action type="end_calibration_average_and_take_sample" calibrator="eyeCalibrator" calibratable_object="fixation_dot" tag="End Calibration Average and Take Sample"></action>
                                        <action _id="id31238" type="assignment" variable="success" value="1" tag="Assignment"></action>
                                        <action _id="id31246" type="dequeue_stimulus" stimulus="fixation_dot" tag="Dequeue Stimulus"></action>
                                        <action _id="id31253" type="update_stimulus_display" tag="Update Stimulus Display"></action>
                                        <action _id="id31257" type="assignment" variable="reward" value="reward_duration" tag="Assignment"></action>
                                        <action _id="id31265" type="assignment" variable="number_of_stm_shown" value="number_of_stm_shown+1" tag="Assignment"></action>
                                        <action _id="id31274" type="assignment" variable="miss_count" value="0" tag="Assignment"></action>
                                        <action _id="id31283" type="accept_selections" selection="calibration_list" tag="Accept Selections"></action>
                                        <transition _id="id31289" type="yield"></transition>
                                    </task_system_state>
                                    <task_system_state _id="id31293" tag="cal failure" interruptible="YES">
                                        <action type="end_calibration_average_and_ignore" calibrator="eyeCalibrator" tag="End Calibration Average and Ignore "></action>
                                        <action _id="id31309" type="report" message="************* MISS!!!! **********" tag="Report"></action>
                                        <action _id="id31315" type="play_sound" sound="failure_sound" tag="play failure_sound"></action>
                                        <action _id="id31324" type="start_timer" timer="rough_cal_timer" duration="500ms" tag="Set Timer"></action>
                                        <transition _id="id31333" target="cal failure end" type="timer_expired" timer="rough_cal_timer"></transition>
                                    </task_system_state>
                                    <task_system_state _id="id31341" tag="cal failure end" interruptible="YES">
                                        <action _id="id31350" type="dequeue_stimulus" stimulus="fixation_dot" tag="Dequeue Stimulus"></action>
                                        <action _id="id31356" type="update_stimulus_display" tag="Update Stimulus Display"></action>
                                        <action _id="id31360" type="assignment" variable="failure" value="1" tag="Assignment"></action>
                                        <action _id="id31369" type="assignment" variable="miss_count" value="miss_count+1" tag="Assignment"></action>
                                        <action _id="id31377" type="reject_selections" selection="calibration_list" tag="Reject Selections"></action>
                                        <transition _id="id31384" target="cal punish" type="conditional" condition="miss_count==7"></transition>
                                        <transition _id="id31393" type="yield"></transition>
                                    </task_system_state>
                                    <task_system_state _id="id31396" tag="cal ignore" interruptible="YES">
                                        <action _id="id31405" type="report" message="************* IGNORE!!!! **********" tag="Report"></action>
                                        <action _id="id31412" type="assignment" variable="ignore" value="1" tag="Assignment"></action>
                                        <action _id="id31420" type="dequeue_stimulus" stimulus="fixation_dot" tag="Dequeue Stimulus"></action>
                                        <action _id="id31427" type="update_stimulus_display" tag="Update Stimulus Display"></action>
                                        <action _id="id31431" type="assignment" variable="miss_count" value="miss_count+1" tag="Assignment"></action>
                                        <action _id="id31439" type="reject_selections" selection="calibration_list" tag="Reject Selections"></action>
                                        <transition _id="id31446" target="cal punish" type="conditional" condition="miss_count==7"></transition>
                                        <transition _id="id31454" type="yield"></transition>
                                    </task_system_state>
                                    <task_system_state _id="id31458" tag="cal punish" interruptible="YES">
                                        <action _id="id31467" type="assignment" variable="miss_count" value="0" tag="Assignment"></action>
                                        <action _id="id31476" type="start_timer" timer="cal_timer" duration="20000ms" tag="Set Timer"></action>
                                        <transition _id="id31484" type="yield"></transition>
                                    </task_system_state>
                                </task_system>
                            </range_replicator>
                        </range_replicator>
                    </list>
                    <task_system _id="id31488" tag="calibration end">
                        <task_system_state _id="id31492" tag="StopIO_state" interruptible="YES">
                            <action _id="id31498" type="report" message="************* CALIBRATION FINISHED **********" tag="Report"></action>
                            <action _id="id31505" type="play_sound" sound="complete_sound" tag="Play Sound"></action>
                            <action _id="id31511" type="update_calibration" calibrator="eyeCalibrator" tag="Update Calibration"></action>
                            <action type="stop_device_IO" device="FakeMonkey" tag="Stop Device IO"></action>
                            <transition _id="id31523" type="yield"></transition>
                        </task_system_state>
                    </task_system>
                </trial>
            </block>
        </protocol>
        <protocol _id="id31527" tag="RSVP protocol" selection="sequential" nsamples="1" sampling_method="cycles" interruptible="YES">
            <block _id="id31543" tag="RSVP block" selection="sequential" nsamples="1" sampling_method="cycles" interruptible="YES">
                <action type="reset_selection" selection="RSVP_test_stim_index" tag="Reset RSVP_test_stim_index"></action>
                <action _id="id31565" type="assignment" variable="images_shown" value="0" tag="Assignment"></action>
                <action _id="id31573" type="assignment" variable="imageGroup_repetition" value="0" tag="Assignment"></action>
                <action _id="id31582" type="assignment" variable="fixation_point_size" value="0.2" tag="Assignment"></action>
                <action _id="id31591" type="assignment" variable="fixation_pos_x" value="0" tag="Assignment"></action>
                <action _id="id31600" type="assignment" variable="fixation_pos_y" value="0" tag="Assignment"></action>
                <trial _id="id31608" tag="RSVP trial" selection="sequential" nsamples="1000" sampling_method="cycles" interruptible="YES">
                    <task_system _id="id31624" tag="RSVP task system">
                        <task_system_state _id="id31628" tag="RSVP check completion" interruptible="YES">
                            <transition _id="id31634" target="RSVP complete" type="conditional" condition="imageGroup_repetition #GE number_repeats"></transition>
                            <transition _id="id31644" target="RSVP ITI" type="direct"></transition>
                        </task_system_state>
                        <task_system_state _id="id31650" tag="RSVP ITI" interruptible="YES">
                            <action _id="id31656" type="start_timer" timer="rsvp_timer" duration="ITI" timebase="" tag="Set Timer"></action>
                            <transition _id="id31667" target="RSVP StartIO_state" type="timer_expired" timer="rsvp_timer"></transition>
                        </task_system_state>
                        <task_system_state _id="id31676" tag="RSVP StartIO_state" interruptible="YES">
                            <action _id="id31682" type="assignment" variable="sync" value="1" tag="Set Sync Variable"></action>
                            <action type="start_device_IO" device="FakeMonkey" tag="Start Fake Monkey IO"></action>
                            <action _id="id31697" type="report" message="********** RSVP TRIAL START **********" tag="Report"></action>
                            <transition _id="id31704" target="RSVP initialization" type="direct"></transition>
                        </task_system_state>
                        <task_system_state _id="id31710" tag="RSVP initialization" interruptible="YES">
                            <action _id="id31717" type="assignment" variable="number_of_stm_shown" value="0" tag="Assignment"></action>
                            <action type="live_queue_stimulus" stimulus="fixation_dot" tag="Live Queue Fixation Dot"></action>
                            <action _id="id31732" type="update_stimulus_display" tag="Update Stimulus Display"></action>
                            <action _id="id31736" type="play_sound" sound="stm_on_sound" tag="Play stm_on_sound"></action>
                            <action _id="id31745" type="start_timer" timer="rsvp_ignore_timer" duration="ignore_time" timebase="" tag="Set Timer"></action>
                            <action _id="id31756" type="if" condition="rand(0,1)>0.1" tag="if  10 percent of the time fake monkey ignores fixation">
                                <action _id="id31762" type="report" message="fixate on target" tag="Report"></action>
                                <action _id="id31769" type="fake_monkey_saccade_and_fixate" duration="rand(0.9,1.5)*(stimon_delay+((stimon_time+stimoff_time)*show_N_images))" fake_monkey="FakeMonkey" h="fixation_pos_x" v="fixation_pos_y" tag="Fake Monkey Saccade and fixate on dot"></action>
                            </action>
                            <transition _id="id31783" target="RSVP wait" type="conditional" condition="(eye_in_window == 1) #AND (saccade==0)"></transition>
                            <transition _id="id31792" target="RSVP ignore" type="timer_expired" timer="rsvp_ignore_timer"></transition>
                        </task_system_state>
                        <task_system_state _id="id31801" tag="RSVP wait" interruptible="YES">
                            <action _id="id31808" type="play_sound" sound="acquire_sound" tag="play acquire_sound"></action>
                            <action _id="id31816" type="start_timer" timer="rsvp_timer" duration="stimon_delay" timebase="" tag="Set Timer"></action>
                            <transition _id="id31827" target="RSVP failure" type="conditional" condition="(eye_in_window == 0) #AND (saccade==0)"></transition>
                            <transition _id="id31836" target="RSVP stim on" type="timer_expired" timer="rsvp_timer"></transition>
                        </task_system_state>
                        <task_system_state _id="id31845" tag="RSVP stim on" interruptible="YES">
                            <action _id="id31851" type="start_timer" timer="stimon_timer" duration="stimon_time" timebase="" tag="Set Stim on Timer"></action>
                            <action _id="id31862" type="report" message="********** stim on: RSVP_images[ $RSVP_test_stim_index ] **********" tag="Report "></action>
                            <action _id="id31869" type="queue_stimulus" stimulus="RSVP_images[RSVP_test_stim_index]" tag="Queue RSVP image"></action>
                            <action type="bring_stimulus_to_front" stimulus="fixation_dot" tag="Bring fixation dot to front"></action>
                            <action _id="id31882" type="update_stimulus_display" tag="Update Stimulus Display"></action>
                            <action _id="id31886" type="if" condition="RSVP_test_stim_index==7" tag="If the image is at index 7 increase the spiking rate">
                                <action _id="id31893" type="assignment" variable="spike_rate" value="400" tag="Assignment"></action>
                            </action>
                            <transition _id="id31901" target="RSVP stim reject" type="conditional" condition="(eye_in_window == 0) #AND (saccade==0)"></transition>
                            <transition _id="id31911" target="RSVP stim off" type="timer_expired" timer="stimon_timer"></transition>
                        </task_system_state>
                        <task_system_state _id="id31919" tag="RSVP stim off" interruptible="YES">
                            <action _id="id31926" type="start_timer" timer="stimoff_timer" duration="stimoff_time" timebase="" tag="Set Stim off Time"></action>
                            <action _id="id31937" type="report" message="************* stim off! **********" tag="Report"></action>
                            <action _id="id31943" type="dequeue_stimulus" stimulus="RSVP_images[RSVP_test_stim_index]" tag="Dequeue RSVP image"></action>
                            <action _id="id31950" type="update_stimulus_display" tag="Update Stimulus Display"></action>
                            <action _id="id31954" type="assignment" variable="spike_rate" value="25" tag="Assignment"></action>
                            <transition _id="id31963" target="RSVP stim reject" type="conditional" condition="(eye_in_window == 0) #AND (saccade==0)"></transition>
                            <transition _id="id31972" target="RSVP stim accept" type="timer_expired" timer="stimoff_timer"></transition>
                        </task_system_state>
                        <task_system_state _id="id31981" tag="RSVP stim accept" interruptible="YES">
                            <action _id="id31988" type="accept_selections" selection="RSVP_test_stim_index" tag="Accept RSVP image index"></action>
                            <action _id="id31994" type="assignment" variable="number_of_stm_shown" value="number_of_stm_shown+1" tag="Assignment"></action>
                            <action _id="id32003" type="assignment" variable="images_shown" value="images_shown+1" tag="Assignment"></action>
                            <action _id="id32012" type="if" condition="images_shown #LT imagesetsize" tag="if all images have not been shown">
                                <action type="next_selection" selection="RSVP_test_stim_index" tag="Next Image index"></action>
                            </action>
                            <action _id="id32025" type="if" condition="images_shown #GE imagesetsize" tag="If all images have been shown">
                                <action type="reset_selection" selection="RSVP_test_stim_index" tag="Reset the RSVP image index"></action>
                                <action _id="id32037" type="assignment" variable="imageGroup_repetition" value="imageGroup_repetition+1" tag="Assignment"></action>
                                <action _id="id32046" type="assignment" variable="images_shown" value="0" tag="Assignment"></action>
                            </action>
                            <transition _id="id32055" target="presuccess" type="conditional" condition="number_of_stm_shown #GE show_N_images"></transition>
                            <transition _id="id32064" target="RSVP stim on" type="conditional" condition="number_of_stm_shown #LT show_N_images"></transition>
                        </task_system_state>
                        <task_system_state _id="id32073" tag="RSVP stim reject" interruptible="YES">
                            <action _id="id32080" type="dequeue_stimulus" stimulus="RSVP_images[RSVP_test_stim_index]" tag="Dequeue RSVP image"></action>
                            <action _id="id32087" type="update_stimulus_display" tag="Update Stimulus Display"></action>
                            <action _id="id32091" type="assignment" variable="spike_rate" value="25" tag="Assignment"></action>
                            <action _id="id32099" type="reject_selections" selection="RSVP_test_stim_index" tag="Reject RSVP image index"></action>
                            <transition _id="id32106" target="RSVP failure" type="direct"></transition>
                        </task_system_state>
                        <task_system_state _id="id32112" tag="presuccess" interruptible="YES">
                            <action _id="id32118" type="start_timer" timer="presuccess_delay_timer" duration="500 ms" timebase="" tag="Set post RSVP timer"></action>
                            <transition _id="id32130" target="RSVP success" type="timer_expired" timer="presuccess_delay_timer"></transition>
                        </task_system_state>
                        <task_system_state _id="id32138" tag="RSVP success" interruptible="YES">
                            <action _id="id32145" type="report" message="************* RSVP Success!!!! **********" tag="Report"></action>
                            <action _id="id32152" type="assignment" variable="reward" value="reward_duration" tag="Assignment"></action>
                            <action _id="id32160" type="assignment" variable="success" value="success+1" tag="Assignment"></action>
                            <action _id="id32169" type="assignment" variable="miss_count" value="0" tag="Assignment"></action>
                            <transition _id="id32177" target="RSVP pause" type="direct"></transition>
                        </task_system_state>
                        <task_system_state _id="id32183" tag="RSVP failure" interruptible="YES">
                            <action _id="id32190" type="report" message="************* RSVP Failure!!!! **********" tag="Report"></action>
                            <action _id="id32196" type="play_sound" sound="failure_sound" tag="play failure_sound"></action>
                            <action _id="id32205" type="assignment" variable="failure" value="failure+1" tag="Assignment"></action>
                            <action _id="id32214" type="assignment" variable="miss_count" value="miss_count+1" tag="Assignment"></action>
                            <transition _id="id32222" target="RSVP pause" type="direct"></transition>
                        </task_system_state>
                        <task_system_state _id="id32228" tag="RSVP ignore" interruptible="YES">
                            <action _id="id32235" type="report" message="************* RSVP Ignored!!!! **********" tag="Report"></action>
                            <action _id="id32241" type="assignment" variable="ignore" value="ignore+1" tag="Assignment"></action>
                            <action _id="id32250" type="assignment" variable="miss_count" value="miss_count+1" tag="Assignment"></action>
                            <transition _id="id32258" target="RSVP pause" type="direct"></transition>
                        </task_system_state>
                        <task_system_state _id="id32265" tag="RSVP punish" interruptible="YES">
                            <action _id="id32271" type="play_sound" sound="failure_sound" tag="play failure_sound"></action>
                            <action _id="id32280" type="assignment" variable="miss_count" value="0" tag="Assignment"></action>
                            <action _id="id32288" type="start_timer" timer="rsvp_timer" duration="2500ms" timebase="" tag="Set failure timer"></action>
                            <transition _id="id32299" target="RSVP StopIO_state" type="timer_expired" timer="rsvp_timer"></transition>
                        </task_system_state>
                        <task_system_state _id="id32308" tag="RSVP pause" interruptible="YES">
                            <action type="dequeue_stimulus" stimulus="fixation_dot" tag="Dequeue fixation dot"></action>
                            <action _id="id32321" type="update_stimulus_display" tag="Update Stimulus Display"></action>
                            <action _id="id32325" type="start_timer" timer="rsvp_timer" duration="500ms" timebase="" tag="Set pause timer"></action>
                            <transition _id="id32336" target="RSVP punish" type="conditional" condition="miss_count==5"></transition>
                            <transition _id="id32344" target="RSVP StopIO_state" type="timer_expired" timer="rsvp_timer"></transition>
                        </task_system_state>
                        <task_system_state _id="id32353" tag="RSVP StopIO_state" interruptible="YES">
                            <action _id="id32360" type="report" message="************* RSVP Trial Completed **********" tag="Report"></action>
                            <action type="stop_device_IO" device="FakeMonkey" tag="stop IO"></action>
                            <action _id="id32375" type="assignment" variable="sync" value="0" tag="Assignment"></action>
                            <transition _id="id32383" target="RSVP complete" type="direct"></transition>
                        </task_system_state>
                        <task_system_state _id="id32389" tag="RSVP complete" interruptible="YES">
                            <action _id="id32396" type="fake_monkey_saccade_and_fixate" duration="0" fake_monkey="FakeMonkey" h="5" v="0" tag="Fake Monkey Saccade and Fixate"></action>
                            <transition _id="id32409" type="yield"></transition>
                        </task_system_state>
                    </task_system>
                </trial>
            </block>
        </protocol>
    </experiment>
</monkeyml>
